{{/*
  Renders a responsive grid of fish images (a "pokemon wall").
  Expects .Page.Params.fish as a list of maps with keys:
    - name: display name of the fish
    - src: absolute or relative URL to the image (e.g., /img/fish/bass.jpg)
*/}}

<style>
  .fishwall-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 16px;
  }
  .fish-card {
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    cursor: pointer;
    background: #f8f8f8;
  }
  .fish-card img {
    width: 100%;
    height: 180px;
    object-fit: cover;
    display: block;
    transition: transform 160ms ease-out;
  }
  .fish-card:hover img {
    transform: scale(1.03);
  }
  .fish-caption {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.55);
    color: #fff;
    padding: 8px 10px;
    font-weight: 600;
    letter-spacing: 0.2px;
    transform: translateY(100%);
    transition: transform 160ms ease-out;
  }
  .fish-card:hover .fish-caption,
  .fish-card.is-open .fish-caption {
    transform: translateY(0%);
  }
  .fishwall-note {
    margin-bottom: 12px;
    color: #666;
    font-size: 0.95em;
  }
  /* Lightbox */
  .fishwall-lightbox {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }
  .fishwall-lightbox.is-open { display: flex; }
  .fishwall-lightbox img {
    max-width: 92vw;
    max-height: 92vh;
    box-shadow: 0 8px 30px rgba(0,0,0,0.45);
    border-radius: 6px;
  }
  .fishwall-lightbox .close-btn {
    position: absolute;
    top: 14px;
    right: 16px;
    color: #fff;
    background: rgba(0,0,0,0.5);
    border: none;
    border-radius: 4px;
    padding: 6px 10px;
    cursor: pointer;
    font-weight: 600;
  }
</style>

<div class="fishwall-grid" data-fishwall>
  {{ $fish := .Page.Param "fish" }}
  {{ if $fish }}
    {{ range $fish }}
      {{ $name := .name }}
      {{ $src := .src }}
      <figure class="fish-card" tabindex="0" aria-label="{{ $name }}" role="group" data-full="{{ $src }}">
        <img src="{{ $src }}" alt="{{ $name }}" loading="lazy">
        <figcaption class="fish-caption">{{ $name }}</figcaption>
      </figure>
    {{ end }}
  {{ else }}
    <div class="fishwall-note">No fish added yet. Add items to <code>fish:</code> in the page front matter.</div>
  {{ end }}
  </div>

<!-- Lightbox modal -->
<div class="fishwall-lightbox" role="dialog" aria-modal="true" aria-label="Image viewer" data-fishwall-lightbox>
  <button class="close-btn" type="button" aria-label="Close">Close âœ•</button>
  <img alt="Full size fish" />
  </div>

<script>
  (function(){
    var container = document.querySelector('[data-fishwall]');
    if(!container) return;

    var lightbox = document.querySelector('[data-fishwall-lightbox]');
    var lightboxImg = lightbox ? lightbox.querySelector('img') : null;
    var closeBtn = lightbox ? lightbox.querySelector('.close-btn') : null;

    function openLightbox(src){
      if(!lightbox || !lightboxImg) return;
      lightboxImg.src = src;
      lightbox.classList.add('is-open');
    }
    function closeLightbox(){
      if(!lightbox) return;
      lightbox.classList.remove('is-open');
      if(lightboxImg) lightboxImg.src = '';
    }

    container.addEventListener('click', function(e){
      var card = e.target.closest('.fish-card');
      if(card) {
        card.classList.toggle('is-open');
        var full = card.getAttribute('data-full');
        if(full) openLightbox(full);
        return;
      }
    });
    container.addEventListener('keydown', function(e){
      if(e.key === 'Enter' || e.key === ' ') {
        var card = e.target.closest('.fish-card');
        if(card) {
          e.preventDefault();
          card.classList.toggle('is-open');
          var full = card.getAttribute('data-full');
          if(full) openLightbox(full);
        }
      }
    });

    if(lightbox){
      lightbox.addEventListener('click', function(e){
        if(e.target === lightbox) closeLightbox();
      });
    }
    if(closeBtn){
      closeBtn.addEventListener('click', closeLightbox);
    }
    document.addEventListener('keydown', function(e){
      if(e.key === 'Escape') closeLightbox();
    });
  })();
  </script>



